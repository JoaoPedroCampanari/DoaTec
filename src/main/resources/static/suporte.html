<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suporte - Plataforma de Doa√ß√£o</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
<header>
    <nav class="navbar">
        <div class="logo"><img src="doatec_logo.png" width="215" alt="Logo DoaTec"></div>
        <ul class="nav-links">
            <li><a href="index.html" class="active">In√≠cio</a></li>
            <li><a href="donate.html">Quero Doar</a></li>
            <li><a href="aluno.html">Preciso de um Computador</a></li>
            <li><a href="suporte.html">Suporte</a></li>
            <li><a href="sobre.html">Sobre N√≥s</a></li>
        </ul>
        <button id="theme-toggle" class="btn-theme-toggle">üåô</button>
        <button id="logoutButton" class="btn btn-secondary" style="margin-left: 10px;">Sair</button> <div class="menu-toggle">
        <span></span>
        <span></span>
        <span></span>
    </div>
    </nav>
</header>

<main>
    <section class="application-section">
        <div class="container">
            <div class="application-header">
                <h1>Central de Suporte</h1>
                <p>Tem alguma d√∫vida? Consulte nossas perguntas frequentes ou entre em contato conosco.</p>
            </div>

            <div class="faq-section">
                <h2 style="text-align: center; margin-bottom: 25px; color: #333;">Perguntas Frequentes</h2>
                <fieldset class="application-form">
                    <legend>Para Doadores</legend>
                    <div class="form-group">
                        <label>Quem pode doar?</label>
                        <p class="form-text">Pessoas f√≠sicas, jur√≠dicas e empresas parceiras podem doar componentes
                            eletr√¥nicos ou computadores completos.</p>
                    </div>
                    <div class="form-group">
                        <label>O que posso doar?</label>
                        <p class="form-text">Aceitamos computadores de mesa, notebooks, e tamb√©m componentes avulsos
                            como processadores, mem√≥rias RAM, HDs/SSDs, fontes, monitores, teclados e mouses em
                            condi√ß√µes de uso.</p>
                    </div>
                </fieldset>

                <fieldset class="application-form">
                    <legend>Para Alunos</legend>
                    <div class="form-group">
                        <label>Quem pode solicitar um computador?</label>
                        <p class="form-text">Alunos de baixa renda que necessitam de um equipamento para os estudos.
                            Inicialmente, o foco do projeto s√£o os alunos da Fatec Gar√ßa, mas planejamos expandir
                            para a regi√£o.</p>
                    </div>
                    <div class="form-group">
                        <label>Como funciona a fila de espera?</label>
                        <p class="form-text">A institui√ß√£o de ensino parceira, como a Fatec Gar√ßa, gerencia a fila
                            de benefici√°rios. A sele√ß√£o √© baseada em crit√©rios socioecon√¥micos a partir da an√°lise
                            dos documentos enviados no formul√°rio de solicita√ß√£o.</p>
                    </div>
                    <div class="form-group">
                        <label>Como saberei se fui selecionado?</label>
                        <p class="form-text">Nossa equipe administrativa entrar√° em contato atrav√©s do e-mail e/ou
                            telefone cadastrado no formul√°rio de solicita√ß√£o para informar sobre a aprova√ß√£o e os
                            pr√≥ximos passos para a retirada do equipamento.</p>
                    </div>
                </fieldset>
            </div>

            <form id="supportForm" class="application-form" style="margin-top: 40px;">
                <fieldset>
                    <legend>Fale Conosco</legend>
                    <p style="text-align: center; margin-bottom: 20px;">Se sua d√∫vida n√£o foi respondida acima,
                        preencha o formul√°rio abaixo.</p>
                    <div class="form-group">
                        <label for="supportName">Seu Nome:</label>
                        <input type="text" id="supportName" name="supportName" required disabled> </div>
                    <div class="form-group">
                        <label for="supportEmail">Seu Email:</label>
                        <input type="email" id="supportEmail" name="supportEmail" required disabled> </div>
                    <div class="form-group">
                        <label for="supportSubject">Assunto:</label>
                        <input type="text" id="supportSubject" name="supportSubject" required>
                    </div>
                    <div class="form-group">
                        <label for="supportMessage">Sua Mensagem:</label>
                        <textarea id="supportMessage" name="supportMessage" rows="6" required></textarea>
                    </div>
                </fieldset>
                <button type="submit" class="btn btn-primary btn-submit">Enviar Mensagem</button>
            </form>
        </div>
    </section>
</main>

<footer>
    <div class="container">
        <p>&copy; 2025 Plataforma de Doa√ß√£o - Fatec Gar√ßa. Todos os direitos reservados.</p>
    </div>
</footer>

<script src="js/main.js"></script>
<script src="js/theme-switcher.js"></script>
<script src="js/auth.js"></script> <script>
    document.addEventListener('DOMContentLoaded', function() {
        const supportForm = document.getElementById('supportForm');
        const supportNameInput = document.getElementById('supportName');
        const supportEmailInput = document.getElementById('supportEmail');

        const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));

        if (loggedInUser && loggedInUser.id) {
            fetch(`/api/users/${loggedInUser.id}`)
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    }
                    throw new Error('Falha ao carregar dados do usu√°rio logado.');
                })
                .then(userData => {
                    supportNameInput.value = userData.nome || '';
                    supportEmailInput.value = userData.email || '';
                })
                .catch(error => {
                    console.error('Erro ao preencher dados de suporte:', error);
                    alert('N√£o foi poss√≠vel carregar seus dados para o formul√°rio de suporte. Por favor, preencha manualmente.');
                    localStorage.removeItem('loggedInUser');
                });
        } else {
            // Se n√£o estiver logado, pode-se exigir login ou deixar os campos preench√≠veis
            alert('Voc√™ precisa estar logado para enviar um formul√°rio de suporte. Por favor, fa√ßa login.');
            window.location.href = 'login.html'; // Redireciona para login se n√£o logado
        }

        supportForm.addEventListener('submit', async (event) => {
            event.preventDefault();

            const formData = {
                nome: supportNameInput.value, // Pega do campo preenchido/desabilitado
                email: supportEmailInput.value, // Pega do campo preenchido/desabilitado
                assunto: document.getElementById('supportSubject').value,
                mensagem: document.getElementById('supportMessage').value
            };

            try {
                const response = await fetch('/api/suporte', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                const message = await response.text();
                alert(message);

                if (response.ok) {
                    supportForm.reset();
                }

            } catch (error) {
                console.error('Erro ao enviar formul√°rio de suporte:', error);
                alert('Ocorreu um erro de conex√£o ao enviar sua mensagem. Verifique o console.');
            }
        });
    });
</script>
</body>
</html>